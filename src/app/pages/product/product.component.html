<div class="page">
  <div class="header">
    <h1 class="header__title" [ngSwitch]="isNewProduct">
      <ng-container *ngSwitchCase="true">
        Новый товар
      </ng-container>

      <ng-container *ngSwitchCase="false">
        {{ product?.name }}
      </ng-container>
    </h1>

    <div class="header__toolbar">
      <button class="header__btn toolbar-btn" (click)="goBack()">
        <i class="ai ai-arrow-left"></i> назад
      </button>
      <button class="header__btn toolbar-btn" *ngIf="!isNewProduct" (click)="delete()">
        Удалить
      </button>
      <button class="header__btn toolbar-main-btn" (click)="save()">Сохранить</button>
    </div>
  </div>

  <form class="product" *ngIf="form" [formGroup]="form">

    <div class="product__field field"
           *ngIf="form.get('isEnabled') as isEnabled"
           [class.field--invalid]="isControlInvalid(isEnabled)"
    >
      <label class="field__label" for="isEnabled">Включить категорию</label>
      <span class="field__control">
        <span class="switcher">
          <input class="switcher__input"
                 [formControl]="isEnabled"
                 type="checkbox"
                 id="isEnabled"
          >
          <span class="switcher__control" [class.switcher__control--active]="isEnabled.value"></span>
          <span class="switcher__description">
            <ng-container *ngIf="isEnabled.value; else isEnabledFalseText">Да</ng-container>
            <ng-template #isEnabledFalseText>Нет</ng-template>
          </span>
        </span>
      </span>
    </div>

    <label class="product__field field field--required"
           *ngIf="form.get('name') as name"
           [class.field--invalid]="isControlInvalid(name)"
    >
      <label for="name" class="field__label">Название товара</label>
      <span class="field__control">
        <input class="field__input" [formControl]="name" type="text" id="name">
      </span>
    </label>

    <label class="product__field field field--required"
           *ngIf="form.get('sku') as sku"
           [class.field--invalid]="isControlInvalid(sku)"
    >
      <label for="sku" class="field__label">Артикул</label>
      <span class="field__control">
        <input class="field__input" [formControl]="sku" type="text" id="sku">
      </span>
    </label>

    <label class="product__field field field--required"
           *ngIf="form.get('price') as price"
           [class.field--invalid]="isControlInvalid(price)"
    >
      <label for="price" class="field__label">Цена</label>
      <span class="field__control">
        <input class="field__input" [formControl]="price" type="text" id="price">
      </span>
    </label>

    <div class="product__field field"
           *ngIf="form.get('qty') as qty"
           [class.field--invalid]="isControlInvalid(qty)"
    >
      <label for="qty" class="field__label">Количество</label>
      <span class="field__control">
        <input class="field__input" [formControl]="qty" type="text" id="qty">
      </span>
    </div>

    <div class="product__field field" *ngIf="form.get('categoryIds') as categoryIds">
      <label class="field__label">Категории</label>
      <span class="field__control">
        <category-select [formControl]="categoryIds"></category-select>
      </span>
    </div>

    <div class="product__field field"
           *ngIf="form.get('fullDescription') as fullDescription"
           [class.field--invalid]="isControlInvalid(fullDescription)"
    >
      <label class="field__label">Описание</label>
      <span class="field__control">
        <angular-editor id="fullDescription" [formControl]="fullDescription" [config]="editorConfig"></angular-editor>
      </span>
    </div>

    <div class="product__field field"
           *ngIf="form.get('shortDescription') as shortDescription"
           [class.field--invalid]="isControlInvalid(shortDescription)"
    >
      <label class="field__label">Короткое описание</label>
      <span class="field__control">
        <angular-editor id="shortDescription" [formControl]="shortDescription" [config]="editorConfig"></angular-editor>
      </span>
    </div>

    <div class="product__field field"
           *ngIf="form.get('slug') as slug"
           [class.field--invalid]="isControlInvalid(slug)"
    >
      <label for="slug" class="field__label">URL адрес</label>
      <span class="field__control">
        <input class="field__input" [formControl]="slug" type="text" id="slug">
      </span>
    </div>

    <div class="product__field field"
           *ngIf="form.get('metaTags.title') as metaTitle"
           [class.field--invalid]="isControlInvalid(metaTitle)"
    >
      <label for="metaTitle" class="field__label">Meta заголовок</label>
      <span class="field__control">
        <input class="field__input" [formControl]="metaTitle" type="text" id="metaTitle">
      </span>
    </div>

    <div class="product__field field"
           *ngIf="form.get('metaTags.description') as metaDescription"
           [class.field--invalid]="isControlInvalid(metaDescription)"
    >
      <label class="field__label">Meta описание</label>
      <span class="field__control">
        <textarea class="field__textarea" [formControl]="metaDescription"></textarea>
      </span>
    </div>

    <div class="product__field field"
           *ngIf="form.get('metaTags.keywords') as metaKeywords"
           [class.field--invalid]="isControlInvalid(metaKeywords)"
    >
      <label class="field__label">Meta ключевые слова</label>
      <span class="field__control">
        <textarea class="field__textarea" [formControl]="metaKeywords"></textarea>
      </span>
    </div>

    <div class="product__field media">
      <media-asset class="media__asset"
                   *ngFor="let media of form.get('medias').value"
                   [media]="media"
                   (remove)="onMediaRemove(media)"
      ></media-asset>

      <media-uploader class="media_asset"
                      [uploadUrl]="getMediaUploadUrl()"
                      (uploaded)="mediaUploaded($event)"
      ></media-uploader>

    </div>

  </form>

</div>

